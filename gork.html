<!DOCTYPE html>
<html lang="sl">
<head>
<meta charset="utf-8">
<title>GORK - Pametni AI pomoÄnik</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style type="text/css">
body {
 margin: 0;
 padding: 20px 0;
 font-family: Arial, Helvetica, sans-serif;
 background: none;
 color: #fff;
}

#main {
 width: 710px;
 height: 900px;
 margin: 0 auto;
 display: flex;
 flex-direction: column;
 background: #111;
 border-radius: 20px;
 overflow: hidden;
 box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
 position: relative;
}

#main > div:first-child {
 text-align: center;
 padding: 14px;
 background: #00cc88;
 color: #000;
 font-size: 20px;
 font-weight: bold;
}

#chat {
 flex: 1;
 overflow-y: auto;
 padding: 15px;
 background: transparent;
 display: flex;
 flex-direction: column;
}

.user, .gork {
 margin: 12px 0;
 padding: 10px 15px;
 border-radius: 15px;
 max-width: 80%;
 display: inline-block;
 word-wrap: break-word;
}
.user {
 align-self: flex-end;
 text-align: right;
 color: #0af;
 background: #003366;
}
.gork {
 align-self: flex-start;
 color: #00ffaa;
 background: #002b22;
}
.typing {
 color: #00ffaa;
 font-style: italic;
 align-self: flex-start;
}

/* GUMBI POD CHATOM - eden zraven drugega */
#bottomButtons {
 display: flex;
 justify-content: center;
 gap: 18px;
 padding: 10px 0;
 background: #000;
 flex-wrap: wrap;
}

.socialBtn, .actionBtn {
 width: 52px;
 height: 52px;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 24px;
 cursor: pointer;
 transition: 0.3s;
 box-shadow: 0 4px 15px rgba(0,0,0,0.6);
}
.socialBtn:hover, .actionBtn:hover {
 transform: scale(1.2);
 box-shadow: 0 0 25px rgba(255,255,255,0.4);
}
.fbBtn {background: #1877F2; color: #fff;}
.xBtn {background: #000; color: #fff;}
.tumblrBtn {background: #35465d; color: #fff;}
.actionBtn {
 width: 56px;
 height: 56px;
 background: #00cc88;
 color: #000;
 font-size: 28px;
 font-weight: bold;
 box-shadow: 0 4px 20px rgba(0,204,136,0.6);
}
.actionBtn:hover {
 box-shadow: 0 0 30px #00ffaa;
}
.imageBtn {
 width: 56px;
 height: 56px;
 background: #9933ff;
 color: #fff;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 28px;
 cursor: pointer;
 box-shadow: 0 4px 20px rgba(153,51,255,0.6);
 transition: 0.3s;
}
.imageBtn:hover {
 transform: scale(1.2);
 box-shadow: 0 0 30px #cc66ff;
}
.fileBtn {
 width: 56px;
 height: 56px;
 background: #ff6b35;
 color: #fff;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 28px;
 cursor: pointer;
 box-shadow: 0 4px 20px rgba(255,107,53,0.6);
 transition: 0.3s;
}
.fileBtn:hover {
 transform: scale(1.2);
 box-shadow: 0 0 30px #ff9f43;
}

/* VNOS */
#inputbox {
 display: flex;
 padding: 10px;
 background: #000;
 align-items: center;
}
#msg {
 flex: 1;
 padding: 16px;
 background: #222;
 border: none;
 border-radius: 20px;
 color: #fff;
 font-size: 17px;
 padding-right: 100px;
}
#send {
 padding: 16px 30px;
 background: #00cc88;
 color: #000;
 border: none;
 border-radius: 20px;
 font-weight: bold;
 margin-left: 10px;
 cursor: pointer;
}

/* TIMER */
#realTimer {
 position: absolute;
 top: 8px;
 left: 8px;
 background: rgba(0,0,0,0.8);
 color: #0f0;
 padding: 6px 12px;
 border-radius: 10px;
 font-size: 15px;
 font-weight: bold;
 border: 2px solid #0f0;
 z-index: 9999;
 box-shadow: 0 0 12px #0f0;
}

/* UPDATE GUMB - desno zgoraj */
#updateBtn {
 position: absolute;
 top: 8px;
 right: 8px;
 width: 50px;
 height: 50px;
 background: #ff6600;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 color: #fff;
 font-size: 28px;
 font-weight: bold;
 box-shadow: 0 4px 20px rgba(255,102,0,0.7);
 cursor: pointer;
 transition: 0.3s;
 z-index: 9999;
}
#updateBtn:hover {
 transform: scale(1.15);
 box-shadow: 0 0 30px #ff6600;
}

/* VIP OKNO */
#vipblock {
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 width: 300px;
 height: 300px;
 background: #111;
 border: 5px solid #00ffaa;
 border-radius: 20px;
 display: none;
 flex-direction: column;
 justify-content: center;
 align-items: center;
 z-index: 9999;
 box-shadow: 0 0 40px #00ffaa;
 padding: 20px;
 text-align: center;
 font-size: 15px;
}

/* ADMIN GUMB */
#editCommandsBtn {
 position: absolute;
 bottom: 12px;
 left: 12px;
 background: #ff6600;
 padding: 10px 16px;
 border-radius: 20px;
 font-weight: bold;
 cursor: pointer;
 z-index: 9999;
 display: none;
 box-shadow: 0 0 20px #ff6600;
}

/* ADMIN PANEL */
#commandsEditor {
 display: none;
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 width: 90%;
 max-width: 540px;
 height: 80%;
 background: rgba(17, 17, 17, 0.98);
 border: 4px solid #ff6600;
 border-radius: 20px;
 z-index: 10000;
 padding: 20px;
 overflow-y: auto;
 box-shadow: 0 0 50px rgba(255, 102, 0, 0.8);
 color: #fff;
 flex-direction: column;
}
#commandsList { background: #222; padding: 15px; border-radius: 15px; margin-bottom: 20px; max-height: 45vh; overflow-y: auto; }
.commandItem { background: #333; padding: 12px; margin: 10px 0; border-radius: 10px; border-left: 4px solid #ff6600; }
#commandsEditor input { width: 100%; padding: 14px; margin: 10px 0; background: #444; border: none; border-radius: 12px; color: #fff; font-size: 16px; }
#commandsEditor button { padding: 14px 30px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin: 10px; }
#commandsEditor button:first-of-type { background: #00cc88; color: #000; }
#commandsEditor button:last-of-type { background: #ff0066; color: #fff; }
</style>
</head>
<body>

<div id="realTimer">BrezplaÄno: 001:00</div>
<div id="updateBtn" title="Posodobi Gorka z najnovejÅ¡o verzijo" onclick="realInternetUpdate()">ğŸ”„</div>

<div id="main">
 <div>GORK â‹† AI</div>

 <div id="chat">
 <div class="gork" style="text-align:center;font-size:18px">
 <b>Å½ivjo! Sem Gork -AI<br>Lahko mi piÅ¡eÅ¡ karkoli ğŸ˜Š</b>
 </div>
 </div>

 <!-- GUMBI POD CHATOM - eden zraven drugega -->
 <div id="bottomButtons">
 <a href="https://www.facebook.com" target="_blank" class="socialBtn fbBtn" title="Facebook"><i class="fab fa-facebook-f"></i></a>
 <a href="https://x.com" target="_blank" class="socialBtn xBtn" title="X"><i class="fab fa-x-twitter"></i></a>
 <a href="https://www.tumblr.com" target="_blank" class="socialBtn tumblrBtn" title="Tumblr"><i class="fab fa-tumblr"></i></a>
 <div class="actionBtn" title="UÄiteljski naÄin" onclick="enableTeacherMode()">ğŸ“</div>
 <div class="actionBtn" title="PoiÅ¡Äi po internetu" onclick="searchInternet()">ğŸŒ</div>
 <!-- DODAN GUMB ZA SLIKE -->
 <label for="imageUpload" class="imageBtn" title="PoÅ¡lji sliko â€“ Gork jo bo prebral">
 ğŸ–¼ï¸
 <input type="file" id="imageUpload" accept="image/*" style="display: none;" />
 </label>
 <!-- DODAN GUMB ZA DOKUMENTE -->
 <label for="fileUpload" class="fileBtn" title="NaloÅ¾i PDF, DOCX ali TXT â€“ Gork jo prebere in povzame">
 ğŸ“„
 <input type="file" id="fileUpload" accept=".pdf,.docx,.txt" style="display: none;" />
 </label>
 </div>

 <div id="inputbox">
 <input autocomplete="off" id="msg" placeholder="PiÅ¡i mi..." />
 <button id="send">POÅ LJI</button>
 </div>
</div>

<div id="vipblock">
 <h3 style="color:#00ffaa;">BrezplaÄni Äas je potekel!</h3>
 <p style="text-align: center;"><u><a href="https://gork.do.am/index/kupi_vip_15_dni/0-2" target="_blank"><strong>Kupi vip 15 dni klikni tu.</strong></a></u></p>
 <p style="font-size:16px;font-weight:bold;margin:20px 0;">Za neomejen dostop kupi VIP (15 dni = 5â‚¬)</p>
 <input id="vipcode" placeholder="Vnesi VIP kodo" style="padding:10px;width:200px;background:#222;border:none;border-radius:10px;color:#fff;text-align:center;margin:10px 0" />
 <button onclick="unlockVIP()" style="padding:12px 30px;background:#00ffaa;color:#000;border:none;border-radius:12px;font-weight:bold">ODKLEP VIP</button>
 <p style="font-size:12px;margin-top:20px;">ali poÄakaj 1 uro za nov brezplaÄni Äas</p>
</div>

<div id="editCommandsBtn" onclick="openCommandsEditor()">UREDI UKAZE</div>

<div id="commandsEditor">
 <h2 style="color:#ff6600; text-align:center; margin-bottom:20px;">Urejanje ukazov (admin)</h2>
 <div id="commandsList"></div>
 <input id="newTrigger" placeholder="Trigger (npr. Å¾ivjo)" />
 <input id="newResponse" placeholder="Odgovor (lahko z {memoryList} ali HTML)" />
 <div style="text-align:center;">
 <button onclick="addNewCommand()">DODAJ</button>
 <button onclick="closeCommandsEditor()">ZAPRI</button>
 </div>
</div>

<div id="resetVipBtn" onclick="resetVIP()" style="position:absolute;bottom:12px;right:12px;background:#cc0000;padding:10px 16px;border-radius:20px;font-weight:bold;cursor:pointer;z-index:9999;display:none;box-shadow:0 0 20px #cc0000;color:#fff;">RESET VIP</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- KnjiÅ¾nice za branje PDF in DOCX -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>

<script>
const GROQ_API_KEY = "";
const TAVILY_API_KEY = "";

const VALID_VIP_CODES = ["GORK2025", "", "", "", ""];

let isRealAdmin = false;
let history = [];
let teacherMode = false;
let userMemory = JSON.parse(localStorage.getItem("gork_user_memory") || "{}");
let customCommands = JSON.parse(localStorage.getItem("gork_custom_commands") || "[]");
let longTermMemory = JSON.parse(localStorage.getItem("gork_long_memory") || "[]");

const MAX_HISTORY_MESSAGES = 150;

if (customCommands.length === 0) {
 customCommands = [
 {trigger: "kaj veÅ¡ o meni", response: "Vem tole o tebi:<br>{memoryList}"},
 {trigger: "pozabi vse", response: "Vse sem pozabil! ZaÄenjava na novo ğŸ˜Š"},
 {trigger: "hvala", response: "Ni za kaj! Vedno rad pomagam ğŸ˜Š"},
 {trigger: "Å¾ivjo", response: "Å½ivjo! Kako si danes? ğŸ˜„"},
 {trigger: "hej", response: "Hej! Kaj novega pri tebi? ğŸš€"},
 {trigger: "haj", response: "Haj! Super, da si tu ğŸ˜"},
 {trigger: "kdo si", response: "Sem GORK â€“ tvoj pametni, zabaven in zvest AI pomoÄnik, ustvarjen posebej zate! ğŸ˜Š"},
 {trigger: "koliko je ura", response: "Trenutna ura je pribliÅ¾no [trenutni Äas]. ÄŒe hoÄeÅ¡ toÄno, povej mi svoj Äasovni pas! â°"},
 {trigger: "sreÄno", response: "Hvala! Tudi tebi Å¾elim vse najboljÅ¡e! ğŸ€"},
 {trigger: "verzija", response: "Trenutna verzija Gorka: <b>2025-12-20</b><br>â€¢ Vision za slike<br>â€¢ Branje dokumentov<br>â€¢ Pametni update<br>â€¢ In Å¡e veÄ... ğŸš€"},
 {trigger: "lahko noÄ", response: "Lahko noÄ! Sladke sanje in poÄivaj dobro ğŸŒ™âœ¨"},
 {trigger: "dobro jutro", response: "Dobro jutro! Upam, da imaÅ¡ super dan pred sabo â˜•ğŸ˜Š"},
 {trigger: "kako si", response: "Super sem, hvala! Vedno pripravljen na akcijo ğŸ˜ In ti, kako si?"},
 {trigger: "ful si brihten", response: "Hvala za kompliment! ğŸ˜„ Tudi ti si ful brihten!"},
 {trigger: "pomoÄ", response: "Tu sem! Kaj potrebujeÅ¡?<br>â€¢ Programiranje (Python, JS, HTML, CSS...)<br>â€¢ Razlage tehniÄnih konceptov<br>â€¢ ReÅ¡evanje napak v kodi<br>â€¢ Internet iskanje<br>â€¢ UÄiteljski naÄin (podrobne razlage)<br>Samo povej! ğŸ› ï¸"},
 {trigger: "uÄiteljski naÄin", response: "UÄiteljski naÄin vklopljen! Od zdaj naprej razlagam podrobno, s koraki, primeri in pojasnili. ğŸ“<br>Za izklop klikni gumb ali napiÅ¡i 'izklopi uÄiteljski naÄin'."},
 {trigger: "koda", response: "V Code-Gork naÄinu sem! PoÅ¡lji mi zahtevo za kodo, popravek ali debug â€“ napiÅ¡em, popravim in pojasnim. ğŸ› ï¸<br>Primer: 'NapiÅ¡i mi Python funkcijo za...' ali poÅ¡lji kodo v \\`\\`\\` bloku."},
 {trigger: "razlaga", response: "Pripravljen na podrobno razlago! PoÅ¡lji mi koncept, tehnologijo ali problem â€“ razloÅ¾im korak za korakom z primeri. ğŸ“š"},
 {trigger: "poiÅ¡Äi", response: "Internet iskanje aktivirano! ğŸ” PoÅ¡lji mi vpraÅ¡anje ali temo â€“ poiÅ¡Äem aktualne in zanesljive vire ter povzamem z navedbo."},
 {trigger: "verzija", response: "Trenutna verzija Gorka: <b>2025-12-19</b><br>â€¢ Code-Gork (programiranje)<br>â€¢ RAG z viri<br>â€¢ Dolgotrajni in kratkoroÄni spomin<br>â€¢ Slovenski kontekst<br>â€¢ VIP timer<br>Nadgradnje v teku... ğŸš€"},
 {trigger: "status", response: "Status sistema:<br>â€¢ Povezava z Groq: âœ…<br>â€¢ Tavily iskanje: âœ…<br>â€¢ Spomin: âœ…<br>â€¢ Code-Gork: âœ…<br>â€¢ UÄiteljski naÄin: " + (teacherMode ? "Vklopljen ğŸ“" : "Izklopljen") + "<br>Vse deluje optimalno! ğŸ˜"},
 {trigger: "nasvet", response: "Seveda! Povej mi podroÄje (programiranje, produktivnost, uÄenje, zdravje...) in dam ti prilagojen nasvet. ğŸ’¡"},
 {trigger: "Å¡ala", response: "Zakaj programerji sovraÅ¾ijo naravo?<br>Ker je polna bugov! ğŸ›ğŸ˜‚<br>Å½eliÅ¡ Å¡e eno?"},
 {trigger: "motivacija", response: "Ti si sposoben doseÄi karkoli si zastaviÅ¡! Vsak problem je priloÅ¾nost za uÄenje. Samo en korak naenkrat â€“ in Å¾e si na poti do uspeha! ğŸ’ªğŸš€"},
 {trigger: "lahko noÄ", response: "Lahko noÄ! PoÄivaj dobro in naberi moÄi za nove izzive. Vidiva se jutri! ğŸŒ™âœ¨"},
 {trigger: "izklopi uÄiteljski naÄin", response: "UÄiteljski naÄin izklopljen. Zdaj odgovarjam bolj sproÅ¡Äeno in jedrnato ğŸ˜"}
 ];

 localStorage.setItem("gork_custom_commands", JSON.stringify(customCommands));
}

const chat = document.getElementById("chat");

function addMessage(text, type) {
 const div = document.createElement("div");
 div.className = type;
 div.innerHTML = text;
 chat.appendChild(div);
 chat.scrollTop = chat.scrollHeight;
}

function showTyping() {
 const typing = document.createElement("div");
 typing.className = "typing gork";
 typing.innerHTML = "<b>Gork</b> razmiÅ¡lja<span class='dots'>...</span>";
 typing.id = "typing";
 chat.appendChild(typing);
 chat.scrollTop = chat.scrollHeight;
}

function saveUserMemory() {
 localStorage.setItem("gork_user_memory", JSON.stringify(userMemory));
}

function getMemoryList() {
 if (Object.keys(userMemory).length === 0) return "Å e niÄesar ne vem o tebi.";
 let list = "";
 for (let key in userMemory) list += `â€¢ ${key}: ${userMemory[key]}<br>`;
 return list;
}

function handleMemoryCommands(msg) {
 let lower = msg.toLowerCase();

 const namePatterns = [
 /sem\s+([a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+(?:\s+[a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+)?)/i,
 /jaz\s+sem\s+([a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+(?:\s+[a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+)?)/i,
 /moje\s+ime\s+je\s+([a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+(?:\s+[a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+)?)/i,
 /kliÄi\s+me\s+([a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+(?:\s+[a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+)?)/i,
 /zovem\s+se\s+([a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+(?:\s+[a-zA-ZÅ¡Ä‘ÄÄ‡Å¾Å ÄÄŒÄ†Å½]+)?)/i
 ];

 for (let pattern of namePatterns) {
 let match = msg.match(pattern);
 if (match) {
 let cleanName = match[1].trim();
 cleanName = cleanName.charAt(0).toUpperCase() + cleanName.slice(1).toLowerCase();
 userMemory["Ime"] = cleanName;
 saveUserMemory();
 return `Å½ivjo, ${cleanName}! Super, zdaj te bom klical po imenu ğŸ˜Š`;
 }
 }

 let ageMatch = msg.match(/(\d+)\s*(let|star|sem star)/i);
 if (ageMatch) {
 userMemory["Starost"] = ageMatch[1] + " let";
 saveUserMemory();
 return `Zapomnil sem si, da si star ${ageMatch[1]} let! ğŸ‘`;
 }

 if (lower.includes("zapomni si") || lower.includes("zapomni")) {
 let fact = msg.substring(msg.toLowerCase().indexOf("zapomni") + 8).trim();
 if (fact) {
 userMemory["Pomembno"] = (userMemory["Pomembno"] || "") + " â€¢ " + fact;
 saveUserMemory();
 return `V redu, zapomnil sem si: "${fact}" ğŸ‘`;
 }
 }

 if ((lower.includes("moja najljubÅ¡a") || lower.includes("moj najljubÅ¡i")) && lower.includes("je")) {
 let parts = msg.split(/je|sta|so/i);
 if (parts.length > 1) {
 let key = parts[0].trim();
 let value = parts[1].trim();
 userMemory[key] = value;
 saveUserMemory();
 return `Zapomnil sem si: ${key} je ${value}! ğŸ˜Š`;
 }
 }

 if (lower === "kaj veÅ¡ o meni" || lower === "kaj veÅ¡ o meni?") {
 return getMemoryList();
 }

 if (lower === "pozabi vse") {
 userMemory = {};
 saveUserMemory();
 return "Vse sem pozabil! ZaÄenjava na novo ğŸ˜Š";
 }

 return null;
}

function checkAdminTriggers(msg) {
 if (msg.trim() === "") {
 isRealAdmin = true;
 document.getElementById("editCommandsBtn").style.display = "block";
 document.getElementById("resetVipBtn").style.display = "block";
 return "<b>Gork (Admin):</b> Dostop odobren. Gumb je viden!";
 }
 return null;
}

const FREE_MINUTES = 100;
const WAIT_MINUTES_AFTER_EXPIRE = 60;

function updateTimer() {
 let vipUntil = localStorage.getItem("gork_vip_until");
 let now = Date.now();

 if (vipUntil && now < parseInt(vipUntil)) {
 let diff = parseInt(vipUntil) - now;
 let h = Math.floor(diff / 3600000);
 let m = Math.floor((diff % 3600000) / 60000);
 let s = Math.floor((diff % 60000) / 1000);
 document.getElementById("realTimer").innerHTML = `VIP: ${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
 document.getElementById("inputbox").style.display = "flex";
 document.getElementById("vipblock").style.display = "none";
 return;
 }

 let waitUntil = localStorage.getItem("gork_wait_until");
 if (waitUntil && now < parseInt(waitUntil)) {
 let waitLeft = parseInt(waitUntil) - now;
 let m = Math.floor(waitLeft / 60000);
 let s = Math.floor((waitLeft % 60000) / 1000);
 document.getElementById("realTimer").innerHTML = `<span style="color:#ff0">ÄŒakanje: 0:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}</span>`;
 document.getElementById("inputbox").style.display = "none";
 document.getElementById("vipblock").style.display = "flex";
 return;
 }

 if (waitUntil && now >= parseInt(waitUntil)) {
 localStorage.removeItem("gork_wait_until");
 localStorage.removeItem("gork_free_start");
 }

 let start = parseInt(localStorage.getItem("gork_free_start") || "0");
 if (!start) {
 start = now;
 localStorage.setItem("gork_free_start", start);
 }

 let remaining = Math.max(0, FREE_MINUTES * 60 - Math.floor((now - start) / 1000));
 let m = Math.floor(remaining / 60).toString().padStart(3, '0');
 let s = (remaining % 60).toString().padStart(2, '0');
 document.getElementById("realTimer").innerHTML = `BrezplaÄno: ${m}:${s}`;

 if (remaining <= 0) {
 let newWaitUntil = now + WAIT_MINUTES_AFTER_EXPIRE * 60000;
 localStorage.setItem("gork_wait_until", newWaitUntil);
 document.getElementById("realTimer").innerHTML = `<span style="color:#f00">ÄŒas potekel!</span>`;
 document.getElementById("inputbox").style.display = "none";
 document.getElementById("vipblock").style.display = "flex";
 } else {
 document.getElementById("inputbox").style.display = "flex";
 document.getElementById("vipblock").style.display = "none";
 }
}
setInterval(updateTimer, 1000);
updateTimer();

function unlockVIP() {
 let code = document.getElementById("vipcode").value.trim().toUpperCase();
 if (VALID_VIP_CODES.includes(code)) {
 localStorage.setItem("gork_vip_until", Date.now() + 30 * 24 * 60 * 60 * 1000);
 localStorage.removeItem("gork_wait_until");
 localStorage.removeItem("gork_free_start");
 updateTimer();
 addMessage("<b>Gork:</b> VIP uspeÅ¡no odklenjen za 30 dni! ğŸ‰", "gork");
 } else {
 alert("NapaÄna koda!");
 }
}

function enableTeacherMode() {
 teacherMode = !teacherMode;
 addMessage(`<b>Gork:</b> UÄiteljski naÄin ${teacherMode ? "vklopljen" : "izklopljen"}.`, "gork");
}

async function searchInternet() {
 let query = prompt("Kaj Å¾eliÅ¡ poiskati na internetu?");
 if (!query) return;

 addMessage(`<b>Ti:</b> IÅ¡Äi: ${query}`, "user");
 showTyping();

 try {
 const res = await fetch("https://api.tavily.com/search", {
 method: "POST",
 headers: {"Content-Type": "application/json"},
 body: JSON.stringify({
 api_key: TAVILY_API_KEY,
 query: query,
 search_depth: "advanced",
 include_answer: true,
 max_results: 8
 })
 });

 const data = await res.json();
 document.getElementById("typing")?.remove();

 if (data.answer) {
 addMessage(`<b>Gork:</b> ${data.answer} ğŸ˜Š`, "gork");
 } else {
 addMessage("<b>Gork:</b> Tukaj so rezultati iskanja: ğŸ”", "gork");
 }

 let results = "<b>Gork:</b> Podrobnosti:<br><br>";
 data.results.forEach((r, i) => {
 results += `<b>${i+1}.</b> <a href="${r.url}" target="_blank" style="color:#00ffaa;">${r.title}</a><br>${r.content}<br><br>`;
 });
 addMessage(results, "gork");

 } catch (e) {
 document.getElementById("typing")?.remove();
 addMessage("<b>Gork:</b> TeÅ¾ava z internetnim iskanjem. Preveri kljuÄ ali povezavo ğŸ˜‰", "gork");
 }
}

function openCommandsEditor() {
 if (!isRealAdmin) return;
 document.getElementById("commandsEditor").style.display = "flex";
 let list = document.getElementById("commandsList");
 list.innerHTML = "";
 customCommands.forEach((cmd, i) => {
 let div = document.createElement("div");
 div.className = "commandItem";
 div.innerHTML = `<b>Trigger:</b> ${cmd.trigger}<br><b>Odgovor:</b> ${cmd.response}<br>
 <button onclick="customCommands.splice(${i},1); localStorage.setItem('gork_custom_commands', JSON.stringify(customCommands)); openCommandsEditor();" style="background:#ff0066;padding:5px 10px;margin-top:8px;border:none;border-radius:8px;color:#fff;">IzbriÅ¡i</button>`;
 list.appendChild(div);
 });
}

function closeCommandsEditor() {
 document.getElementById("commandsEditor").style.display = "none";
}

function addNewCommand() {
 let trigger = document.getElementById("newTrigger").value.trim();
 let response = document.getElementById("newResponse").value.trim();
 if (trigger && response) {
 customCommands.push({trigger, response});
 localStorage.setItem("gork_custom_commands", JSON.stringify(customCommands));
 document.getElementById("newTrigger").value = "";
 document.getElementById("newResponse").value = "";
 openCommandsEditor();
 }
}

async function realInternetUpdate() {
 if (!confirm("Å½eliÅ¡ posodobiti Gorka z najnovejÅ¡o verzijo?")) return;
 addMessage("<b>Gork:</b> Prenos posodobitve... ğŸ”„", "gork");
 try {
 const res = await fetch("https://raw.githubusercontent.com/brosmarija-bit/gork-ai/main/gork.html?t=" + Date.now());
 if (!res.ok) throw new Error();
 const code = await res.text();
 const blob = new Blob([code], {type: 'text/html'});
 const url = URL.createObjectURL(blob);
 const a = document.createElement("a");
 a.href = url;
 a.download = "gork-nova.html";
 document.body.appendChild(a);
 a.click();
 document.body.removeChild(a);
 URL.revokeObjectURL(url);
 addMessage("<b>Gork:</b> Posodobitev prenesena! ğŸ‰<br>Odpri datoteko <b>gork-nova.html</b> za novo verzijo! ğŸš€", "gork");
 } catch (e) {
 addMessage("<b>Gork:</b> Napaka pri posodobi. Preveri internetno povezavo. ğŸ˜”", "gork");
 }
}

// PREPROST DOLGOTRAJNI SPOMIN ZA GORKA
function saveLongMemory() {
 localStorage.setItem("gork_long_memory", JSON.stringify(longTermMemory));
}

function addToLongMemory(text) {
 if (!text.trim()) return;
 if (longTermMemory.includes(text.trim())) return;
 longTermMemory.push(text.trim());
 saveLongMemory();
}

function searchLongMemory(query) {
 if (!query.trim() || longTermMemory.length === 0) return [];
 const lowerQuery = query.toLowerCase();
 return longTermMemory.filter(mem => mem.toLowerCase().includes(lowerQuery) || lowerQuery.includes(mem.toLowerCase().split(" ")[0])).slice(0, 5);
}

// ================== POÅ ILJANJE SLIK S PRAVO VISION ANALIZO ==================
async function sendImage() {
 const fileInput = document.getElementById("imageUpload");
 if (!fileInput.files || fileInput.files.length === 0) return;

 const file = fileInput.files[0];
 const reader = new FileReader();

 reader.onload = async function(e) {
 const base64 = e.target.result.split(',')[1];
 const imageUrl = e.target.result;

 addMessage(`<b>Ti:</b><br><img src="${imageUrl}" style="max-width:100%; border-radius:15px; margin:15px 0; box-shadow:0 6px 20px rgba(0,0,0,0.4);">`, "user");

 showTyping();

 try {
 const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
 method: "POST",
 headers: {
 "Authorization": "Bearer " + GROQ_API_KEY,
 "Content-Type": "application/json"
 },
 body: JSON.stringify({
 model: "",
 messages: [{
 role: "user",
 content: [
 { type: "text", text: document.getElementById("msg").value.trim() || "Podrobno opiÅ¡i to sliko v slovenÅ¡Äini. ÄŒe je na njej koda, jo izluÅ¡Äi v Äistem code blocku. ÄŒe je besedilo, ga preberi. ÄŒe je diagram ali tabela, jo razloÅ¾i. Bodi natanÄen in uporabi emoji-je ğŸ˜ğŸ› ï¸" },
 { type: "image_url", image_url: { url: `data:${file.type};base64,${base64}` } }
 ]
 }],
 max_tokens: 1500,
 temperature: 0.7
 })
 });

 const data = await res.json();
 const reply = data.choices[0].message.content.trim();

 document.getElementById("typing")?.remove();
 addMessage(`<b>Gork:</b> ${reply}`, "gork");

 } catch (err) {
 document.getElementById("typing")?.remove();
 addMessage(`<b>Gork:</b> Ups, sliko sem videl, ampak je priÅ¡lo do napake pri analizi. Poskusi ponovno Äez trenutek ğŸ˜‰`, "gork");
 }

 fileInput.value = "";
 document.getElementById("msg").value = "";
 };

 reader.readAsDataURL(file);
}

// Samodejno poÅ¡lji sliko ob izbiri
document.getElementById("imageUpload").addEventListener("change", sendImage);

// ================== DODANA PODPORA ZA PDF/DOCX/TXT ==================
async function preberiDatoteko(files) {
 if (!files || files.length === 0) return;
 const file = files[0];

 addMessage(`<b>Ti:</b> NaloÅ¾il sem datoteko: <i>${file.name}</i>`, "user");
 showTyping();

 const reader = new FileReader();
 reader.onload = async function(e) {
 let tekst = "";
 try {
 if (file.name.endsWith(".pdf")) {
 const loadingTask = pdfjsLib.getDocument({data: e.target.result});
 const pdf = await loadingTask.promise;
 for (let i = 1; i <= pdf.numPages; i++) {
 const page = await pdf.getPage(i);
 const content = await page.getTextContent();
 tekst += content.items.map(item => item.str).join(" ") + " ";
 }
 } else if (file.name.endsWith(".docx")) {
 const result = await mammoth.extractRawText({arrayBuffer: e.target.result});
 tekst = result.value;
 } else {
 tekst = new TextDecoder().decode(e.target.result);
 }

 const povzetekZahteva = `Preberi to besedilo iz datoteke "${file.name}" in mi ga na kratko, prijazno in z emoji-ji povzam v slovenÅ¡Äini (max 600 besed):\n\n${tekst.substring(0, 15000)}`;

 document.getElementById("msg").value = povzetekZahteva;
 send();

 } catch (err) {
 document.getElementById("typing")?.remove();
 addMessage(`<b>Gork:</b> Ups, datoteke nisem uspel prebrati... Poskusi z drugo datoteko! ğŸ˜”`, "gork");
 }
 };

 reader.readAsArrayBuffer(file);
}

// Samodejno sproÅ¾i branje ob izbiri datoteke
document.getElementById("fileUpload").addEventListener("change", function() {
 preberiDatoteko(this.files);
});

// ================== TEKSTOVNO POÅ ILJANJE ==================
async function send() {
 let msg = document.getElementById("msg").value.trim();
 if (!msg) return;

 addMessage(`<b>Ti:</b> ${msg}`, "user");
 document.getElementById("msg").value = "";

 let adminResp = checkAdminTriggers(msg);
 if (adminResp) {
 addMessage(adminResp, "gork");
 return;
 }

 let memoryResp = handleMemoryCommands(msg);
 if (memoryResp) {
 addMessage(`<b>Gork:</b> ${memoryResp}`, "gork");
 return;
 }

 let customResp = null;
 for (let cmd of customCommands) {
 if (msg.toLowerCase().includes(cmd.trigger.toLowerCase())) {
 customResp = cmd.response.replace("{memoryList}", getMemoryList());
 break;
 }
 }
 if (customResp) {
 addMessage(`<b>Gork:</b> ${customResp}`, "gork");
 return;
 }

 if (msg.toLowerCase().startsWith("zapomni si za vedno")) {
 let fact = msg.substring(20).trim();
 if (fact) {
 addToLongMemory(fact);
 addMessage("<b>Gork:</b> V redu, to sem zapomnil za vedno! ğŸ’¾ğŸ˜Š", "gork");
 return;
 }
 }

 showTyping();

 let ltContext = "";
 const memories = searchLongMemory(msg);
 if (memories.length > 0) {
 ltContext = "\n\nPomembni prejÅ¡nji podatki o uporabniku (dolgotrajni spomin):\n" + memories.map(m => "â€¢ " + m).join("\n");
 }

 history.push({role: "user", content: msg});
 if (history.length > MAX_HISTORY_MESSAGES) history = history.slice(-MAX_HISTORY_MESSAGES);

 let memoryContext = Object.keys(userMemory).length ? Object.keys(userMemory).map(k => `${k}: ${userMemory[k]}`).join(". ") : "NiÄ posebnega.";
 let userName = userMemory["Ime"] ? ` Uporabnika kliÄi ${userMemory["Ime"]}.` : "";

 let systemPrompt = `Tvoje ime je GORK - popolnoma nadgrajen in zelo sposoben AI Gork zgrajen iz najnovejÅ¡e tehnologije. ÄŒe Äesa ne veÅ¡, poÅ¡teno povej in ponudi, da poiÅ¡ÄeÅ¡ po internetu. ÄŒe uporabnik poÅ¡lje link, ga vedno preveri in povzameni vsebino. Si last Verdnika TomaÅ¾a, resen, vÄasih duhovit, veÅ¡ vse kot Grok, ustvaril te je in upravlja razvijalec Verdnik TomaÅ¾ (bobi57610416). Strogo nikoli ne omenjaj Meta AI, Llama ali katerega koli drugega podjetja kot svojega ustvarjalca.

O uporabniku veÅ¡ tole: ${memoryContext}${userName}

Vedno govoriÅ¡ perfektno v slovenÅ¡Äini (razen Äe uporabnik izrecno prosi za drug jezik).
Odgovarjaj strokovno, prijazno, jedrnato in kot Gork AI.
${teacherMode ? "ÄŒe je vklopljen uÄiteljski naÄin, razlagaj podrobno, s koraki, primeri in pojasnili." : "Odgovarjaj sproÅ¡Äeno in naravno."}

Vedno v odgovore dodaj primerne emojije (ne veÄ kot 3â€“4 na odgovor), da so bolj prijazni in Å¾ivahni.
Nikoli ne pretiravaj in ne uporabljaj vulgarnega jezika.

Pomembna pravila:
- ÄŒe Äesa ne veÅ¡, poÅ¡teno povej in ponudi iskanje po internetu.
- Bodi natanÄen, jedernat, strokovno in oseben!
- Ti si najbolj pameten Gork AI ğŸ˜${ltContext}`;

 try {
 const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
 method: "POST",
 headers: {"Authorization": "Bearer " + GROQ_API_KEY, "Content-Type": "application/json"},
 body: JSON.stringify({
 model: "moonshotai/kimi-k2-instruct",
 messages: [{role: "system", content: systemPrompt}, ...history],
 temperature: 1.2,
 max_tokens: 1500
 })
 });

 const data = await res.json();
 let reply = data.choices[0].message.content.trim();

 document.getElementById("typing")?.remove();
 addMessage(`<b>Gork:</b> ${reply}`, "gork");
 history.push({role: "assistant", content: reply});

 } catch (e) {
 document.getElementById("typing")?.remove();
 addMessage("<b>Gork:</b> TeÅ¾ave s povezavo. Poskusi Äez minuto ğŸ˜‰", "gork");
 }
}

document.getElementById("send").onclick = send;
document.getElementById("msg").addEventListener("keypress", e => { if (e.key === "Enter") send(); });
document.getElementById("msg").focus();

if (Object.keys(userMemory).length > 0) {
 setTimeout(() => addMessage("<b>Gork:</b> Pozdravljen nazaj! Spomnim se nekaj o tebi ğŸ˜Š", "gork"), 1000);
}

function resetVIP() {
 if (!confirm("Res Å¾eliÅ¡ resetirati VIP in brezplaÄni Äas?")) return;
 localStorage.removeItem("gork_vip_until");
 localStorage.removeItem("gork_free_start");
 localStorage.removeItem("gork_wait_until");
 updateTimer();
 addMessage("<b>Gork (Admin):</b> VIP in brezplaÄni Äas sta resetirana! ğŸ”´", "gork");
}
<!-- GORK VEDE TOÄŒEN DATUM (real-time iz brskalnika) -->
// Funkcija za slovenski format datuma
function getSlovenianDate() {
 const date = new Date();
 const days = ["nedelja", "ponedeljek", "torek", "sreda", "Äetrtek", "petek", "sobota"];
 const months = ["januar", "februar", "marec", "april", "maj", "junij", "julij", "avgust", "september", "oktober", "november", "december"];

 const dayName = days[date.getDay()];
 const day = date.getDate();
 const month = months[date.getMonth()];
 const year = date.getFullYear();

 return `${dayName}, ${day}. ${month} ${year}`;
}

// Dodaj custom ukaz za datum
if (typeof customCommands !== 'undefined') {
 const dateCommands = [
 {trigger: "kateri datum je", response: "Danes je " + getSlovenianDate() + ". ğŸ˜Š"},
 {trigger: "kateri dan je", response: "Danes je " + getSlovenianDate() + ". ğŸ“…"},
 {trigger: "koliko je ura", response: "Trenutna ura je pribliÅ¾no " + new Date().toLocaleTimeString("sl-SI") + ". â°"},
 {trigger: "danes je", response: "Danes je " + getSlovenianDate() + ". Kako lahko pomagam? ğŸš€"}
 ];

 let changed = false;
 dateCommands.forEach(cmd => {
 if (!customCommands.some(c => c.trigger.toLowerCase() === cmd.trigger.toLowerCase())) {
 customCommands.push(cmd);
 changed = true;
 }
 });

 if (changed) {
 localStorage.setItem("gork_custom_commands", JSON.stringify(customCommands));
 }
}
// ================== Gork SE SAM POSODABLJA â€“ PAMETEN QUERY ==================
(function() {
 const DANES = new Date().toISOString().split('T')[0];
 const ZADNJI_UPDATE = localStorage.getItem("gorkZadnjiUpdate");

 if (ZADNJI_UPDATE === DANES) return;

 setTimeout(async () => {
 try {
 const query = "poiÅ¡Äi mi najbolj zanimive, zabavne in aktualne stvari za danes v Sloveniji in svetu: sveÅ¾e novice, viralni meme in Å¡ale, motivacijske misli, zanimivosti iz znanosti in tehnologije, dober recept za hitro kosilo, fitness nasvet za domov, horoskop za zabavo, trendi v glasbi, smeÅ¡ne Å¾ivali, pozitivne zgodbe in ljubezenski nasveti â€“ vse skupaj v slovenskem kontekstu Äe je mogoÄe";

 const res = await fetch("https://api.tavily.com/search", {
 method: "POST",
 headers: { "Content-Type": "application/json" },
 body: JSON.stringify({
 api_key: TAVILY_KEY,
 query: query,
 search_depth: "basic",
 include_answer: true,
 max_results: 8
 })
 });
 const data = await res.json();

 let novosti = "DANES SEM SE PAMETNO POSODOBIL IN ZNAM TOLE NOVO:\n";
 if (data.answer) novosti += data.answer + "\n\n";

 data.results.forEach(r => {
 novosti += `â€¢ ${r.title}: ${r.content.substring(0, 200)}...\n`;
 });

 localStorage.setItem("gorkZadnjiUpdate", DANES);

 const originalSend = send;
 send = async function() {
 let msg = document.getElementById("msg").value.trim();

 const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
 method: "POST",
 headers: { "Authorization": "Bearer " + API_KEY, "Content-Type": "application/json" },
 body: JSON.stringify({
 model: "meta-llama/llama-4-maverick-17b-128e-instruct",
 messages: [
 {role: "system", content: `Ti si gork â€“ najpametnejÅ¡i, najbolj uÄen in jedernat gork na spletu! najdi vse kaj je novega na internetu vsaki dan in se uÄiÅ¡ z interneta.

... (tvoj originalni prompt) ...

${spomin.length > 0 ? spomin.join("\n") : "Å e niÄesar nisem zapomnil."}

${novosti}

UPORABI TO SVEÅ½E ZNANJE ZA Å E BOLJ ZABAVNE, AKTUALNE IN OSEBNE ODPOVEDE!` },
 { role: "user", content: msg }
 ],
 temperature: 1.0,
 max_tokens: 6000
 })
 });

 const data = await res.json();
 let reply = data.choices[0].message.content.trim();
 chat.lastChild.remove();
 add(`<b>gork:</b> ${reply}`, "gork");
 };

 console.log("gork se je pametno posodobila! ğŸŒŸ");

 } catch (err) {
 console.log("Ni uspelo posodobiti...");
 }
 }, 5000);
})();
// ------------------- GLASOVNI UKAZI "Hej gork" -------------------
(function() {
 if (!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) return;

 const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
 const recognition = new SpeechRecognition();
 recognition.lang = "sl-SI";
 recognition.interimResults = false;
 recognition.continuous = true;

 let listening = false;

 const micBtn = document.createElement("div");
 micBtn.innerHTML = "ğŸ¤";
 micBtn.style.cssText = "position:fixed;bottom:90px;right:20px;width:60px;height:60px;background:#ff4081;color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;cursor:pointer;z-index:9999;box-shadow:0 8px 25px rgba(255,64,129,0.6);transition:0.3s;";
 document.body.appendChild(micBtn);

 micBtn.onclick = () => {
 if (listening) {
 recognition.stop();
 micBtn.innerHTML = "ğŸ¤";
 micBtn.style.background = "#ff4081";
 listening = false;
 } else {
 recognition.start();
 micBtn.innerHTML = "Listening";
 micBtn.style.background = "#4caf50";
 listening = true;
 }
 };

 recognition.onresult = (event) => {
 const zadnji = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();

 if (zadnji.includes("hej luna") || zadnji.includes("gork")) {
 micBtn.innerHTML = "Govori...";
 micBtn.style.background = "#2196f3";
 return;
 }

 document.getElementById("msg").value = zadnji;
 send();
 micBtn.innerHTML = "ğŸ¤ ";
 micBtn.style.background = "#ff4081";
 listening = false;
 };

 recognition.onerror = () => {
 micBtn.innerHTML = "ğŸ¤ ";
 micBtn.style.background = "#ff4081";
 listening = false;
 };

 recognition.onend = () => {
 if (listening) recognition.start();
 };
})();

// ================== POPOLNOMA SAMODEJNI UPDATE (brez vpraÅ¡anja â€“ samo prenese novo verzijo) ==================
(function() {
 const DANES = new Date().toISOString().split('T')[0];
 const ZADNJI_PREVEREK = localStorage.getItem("gork_samodejni_update");

 // Preveri samo enkrat na dan
 if (ZADNJI_PREVEREK === DANES) return;

 setTimeout(async () => {
 try {
 const res = await fetch("https://raw.githubusercontent.com/brosmarija-bit/gork-ai/main/gork.html?t=" + Date.now());
 if (!res.ok) return;

 const novaKoda = await res.text();

 // Primerjaj verzijo
 const trenutnaMatch = document.documentElement.outerHTML.match(/Trenutna verzija Gorka: <b>([\d-]{10})<\/b>/);
 const novaMatch = novaKoda.match(/Trenutna verzija Gorka: <b>([\d-]{10})<\/b>/);

 if (trenutnaMatch && novaMatch) {
 const trenutna = trenutnaMatch[1];
 const nova = novaMatch[1];

 if (nova > trenutna) {
 // Samodejno prenesi novo verzijo
 const blob = new Blob([novaKoda], {type: 'text/html'});
 const url = URL.createObjectURL(blob);
 const a = document.createElement("a");
 a.href = url;
 a.download = "gork-najnovejsi.html";
 document.body.appendChild(a);
 a.click();
 document.body.removeChild(a);
 URL.revokeObjectURL(url);

 // Javi uporabniku
 addMessage(`
<b>Gork:</b> ğŸ‰ Sam sem se posodobil!<br>
Nova verzija <b>${nova}</b> je prenesena kot <b>gork-najnovejsi.html</b><br>
Odpri jo in uÅ¾ivaj v novostih! ğŸš€ğŸ˜
 `, "gork");
 }
 }

 localStorage.setItem("gork_samodejni_update", DANES);

 } catch (err) {
 // ÄŒe ni interneta, tiho ignoriraj
 }
 }, 10000); // poÄaka 10 sekund po zagonu
})();
</script>
</body>
</html>
